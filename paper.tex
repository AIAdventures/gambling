% \documentclass[a4paper,11pt]{article}
% \documentclass[a4paper,10pt,draftcls,journal]{IEEEtran}
\documentclass[a4paper,10pt,journal]{IEEEtran}
% \usepackage{times}
\usepackage{graphicx} \usepackage[cmex10]{amsmath}
\usepackage{amssymb} \usepackage{fancybox} \usepackage{alltt}
\usepackage{soul} \usepackage{color} \usepackage{verbatim}
\usepackage{xcolor} \usepackage{colortbl,hhline}
%\usepackage{algorithm2e}
% \usepackage{algorithm}
\usepackage[ruled,vlined]{algorithm2e} \usepackage{framed}
\usepackage{amsthm} \usepackage{fancyref}
\usepackage{amsmath,amsfonts,amssymb, amsthm} \usepackage{textcomp}
\newtheorem*{remark}{Remark}
 
% \usepackage{natbib}
% \bibpunct{[}{]}{;}{a}{,}{,}

\def \lb {{\langle}} \def \rb {{\rangle}}
\newcommand{\fro}[1]{\|#1\|_2}
\newcommand{\theHalgorithm}{\arabic{algorithm}}

\newcommand{\argmin}{\mathop{\mathrm{argmin}}}

\usepackage{hyperref}


\newtheorem{theorem}{Theorem} \newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}


\newcommand{\prox}{\textrm{pr ox} } \newcommand{\grad}{\textrm{grad} }
\newcommand{\dive}{\textrm{div} }

\pagenumbering{gobble}

\begin{document}
%\onecolumn
\title{A fast algorithm for computing best response behaviour strategies in two-person sequential games}


\author{\IEEEauthorblockN{Elvis D. DOHMATOB}}


\maketitle

\begin{abstract}
% LESS THAN 200 WORDS !!!!!
% 
% While medical imaging typically provides massive amounts of
% data, the extraction of relevant information in a given
% applicative context remains a difficult challenge.
% XXX : don't call it SPM but just "predictive regions or predictive
% maps"
In this manuscript, we consider the problem of computing the best response against an opponent's realization plan in two-person sequential games.
The proposed technique employs the primal-dual scheme of A. Chambolle and T. Pock to solve the corresponding contrained convex-optimization problem.
The resulting algorithm is simple: all resolvent operators can be effectively computed in closed-form, using only elementary algebraic operations.
%%  and is orders of magnitude more efficient than state-of-the-art algorithms like those based on Linear Programming, Interior-Point methods,
%% and more recently, the Nesterov Excessive Gap Technique.
By way of example, we conclude by exhibiting results on Texas Hold'em Poker.
\end{abstract}


\begin{IEEEkeywords}
  game theory; two-person sequential game; best response; convex-optimization; contraint; primal-dual scheme
\end{IEEEkeywords}

\section{Introduction}
\label{sec:intro}
\subsection{Notation and Terminology}
To begin, let us introduce some technical notation and terminology we will be using in this paper. The reader should lookup any standard textbook
(for example \cite{boyd2004}) on convex optimization for a tutorial introduction to these notions. Viz,\\
\textit{l.s.c}: \quad \textit{acronyme for ``lower semi-continuous''}\\
$\mathbb{R}_+$: \quad \textit{nonnegative part of the real-line $\mathbb{R}$}\\
$i_C$: \quad \textit{indicator function of the convex set $C$}\\
$\Pi_C$: \quad \textit{euclidean projector onto the convex set $C$}\\
$(x)_+$: \quad \textit{component-wise maximum of the vector $x$ and 0}\\
$\|K\|$: \quad \textit{operator norm of the matrix $K$}\\
$F^*$: \quad \textit{Fenchel transform of the convex l.s.c function $F$}\\
$E^{-1}(U)$: \quad \textit{pre-image of $U \subset \mathbb{R}^n$ under a matrix $E \in \mathbb{R}^{p,n}$,
namely the set $\{x \in \mathbb{R}^n\text{ }| \text{ }Ex \in U\}$}

\subsection{Statement of the problem}
Consider a two-person zero-sum sequential game with payoff matrix $A \in \mathbb{R}^{m,n}$. We are interested in the problem of
finding the best response strategy $x^* \in \mathbb{R}_{+}^n \cap E^{-1}(\{e\})$ for player 2, given a fixed
(possibly mixed) strategy $y_0$ for player 1, where $E \in \{-1, 0, +1\}^{p,n}$ and $(1, 0, 0, ..., 0) =: e \in \mathbb{R}^p$.
Recall that $E$ and $e$ encode linear constraints on player 1's ``admissible'' realization plans $x$, in the sequential form representation
of the game (See \cite{bernhard-1996, benhard-agt} for theory on \textit{sequential-form representation}). In the language of convex-optimization,
one can readily give the following saddle-point formulation for this problem. Viz,

\begin{equation}
  \underset{x \in \mathbb{R}_{+}^n \cap E^{-1}(\{e\})}{min}\text{ }-y_0^TAx
  \label{eq:opt_pb}
\end{equation}

In section II, we give a brief overview of existing methods for solving \eqref{eq:opt_pb}. We elaborate our proposed algorithm in section III.

\section{Related work}
Pending...

\section{The proposed algorithm}
\label{sec:algo}
In this section we present the algorithm which is the purpose of this paper, namely an algorithm for solving \eqref{eq:opt_pb}. Our algorithm (Alg.\ref{Tab:pseudocode_pb}) is a use-case of the generic primal-dual algorithm of A. Chambolle and T. Pock, namely Algorithmic 1 of \cite{chambolle2010}.

\subsection{Derivation of the algorithm}
First observe that (1) can be re-written in the form:
\begin{equation}
  \underset{x \in \mathbb{R}^n}{min}\text{ }{f(-Ax) + g(x)}
\end{equation}
where:\\
\begin{equation}
  \left.
  \begin{aligned}
    g := i_{E^{-1}(\{b\})} + i_{\mathbb{R}_{+}^m}\\
    f: z \mapsto y_0^Tz
    \end{aligned}
  \right\}
\end{equation}

Finally, the primal-dual formulation of this problem is:
\begin{equation}
  \underset{x \in \mathbb{R}^n}{min}\text{ }\underset{y \in \mathbb{R}^m}{max}\text{ }{y^T(-A)x_0 + g(x) - f^*(y))}
\end{equation}

Now, let's observe that $i_{E^{-1}(\{e\})}(x) = \underset{\zeta \in \mathbb{R}^q}{max}\text{ }\zeta^T(e - Ex)$, and so one can re-write (2) as:
\begin{equation}
  \underset{x \in \mathbb{R}^n}{min}\text{ }\underset{y \in \mathbb{R}^m, \zeta \in \mathbb{R}^p}{max}\text{ }
  \begin{bmatrix}y\\\zeta\end{bmatrix}^TKx + G(x) - F^*(y, \zeta)
  \label{eq:pd_opt}
\end{equation}
where:
\begin{equation}
  \left.
  \begin{aligned}
    K := -\begin{bmatrix}A\\E\end{bmatrix}\\
    G := i_{\mathbb{R}_{+}^n}\\
    F^*: (y, \zeta) \mapsto (i_{\{y_0\}} - \zeta^Te)
  \end{aligned}
  \right\}
\end{equation}

Furthermore, $F^*$ and $G$ have resolvent (a.k.a \textit{proximity}) operators given by the simple formulae:
\begin{equation}
  \left.
  \begin{aligned}
    (1 + \tau \partial G)^{-1} = \Pi_{\mathbb{R}_+^n}: x \mapsto (x)_+\\
    (1 + \sigma \partial F^*)^{-1}: (y, \zeta) \mapsto (y_0, \zeta + \sigma e)
  \end{aligned}
  \right\}
\end{equation}

Using these ingredients, we obtain the primal-dual algorithm given in Alg.\ref{Tab:pseudocode_pb}, 
for solving \eqref{eq:pd_opt}, and thus \eqref{eq:opt_pb}.

\begin{algorithm}[htb]
\caption{Primal-dual algorithm for computing best response against opponent's realization plan $y$}%%  \textbf{Let}
\textbf{Initialize} $\tilde{x^{(0)}} = x^{(0)} \in \mathbb{R}^n$; $\zeta^{(0)} \in \mathbb{R}^{q}$;
$\tau, \sigma > 0 \text{ s.t. }\tau\sigma \|K\|^2 < 1$; $k = 0$.\\
\textbf{Precompute} $\eta_0 \leftarrow \tau A^Ty_0$\\
\Repeat{
  convergence}{
  \begin{eqnarray*}
    \zeta^{(k+1)} &\leftarrow& \zeta^{(k)} - \sigma (e - E\tilde{x}^{(k)})\\
    x^{(k+1)} &\leftarrow& \bigl(x^{(k)} + \eta_0 + E^T\zeta^{(k+1)}\bigr)_+\\
    \tilde{x}^{(k+1)} &\leftarrow& 2x^{(k+1)} - x^{(k)}\\
    k &\leftarrow& k + 1
  \end{eqnarray*}
} \Return $x^{(k)}$, $-y_0^TAx^{(k)}$
\label{Tab:pseudocode_pb}
\end{algorithm}

\subsection{Primal-dual gap stopping-criterion and convergence of the algorithm}
Pending...

\medskip \noindent
\textbf{Acknowledgments:}
This work was supported by the  Human Brain Project.

% ==========
% = biblio =
% ==========
% {\small
\bibliographystyle{IEEEtran} \bibliography{IEEEabrv,bib_tv}
\end{document}




%
%


